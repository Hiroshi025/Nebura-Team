<!-- Support Section -->
<div class="page-section" id="support">
  <h2
    class="glitch"
    data-text="SUPPORT CENTER"
    style="font-weight: 700; font-size: 24px; margin-bottom: 25px; text-align: center"
    data-lang-key="support-center"
  >
    SUPPORT CENTER
  </h2>
  <div class="support-links">
    <a href="https://discord.gg/nebura" class="support-link" target="_blank">
      <div class="support-icon discord-icon">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
          <path
            d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028c.462-.63.874-1.295 1.226-1.994a.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"
          />
        </svg>
      </div>
      <div>
        <div style="font-weight: 500" data-lang-key="discord-server">Discord Server</div>
        <div style="font-size: 12px; color: var(--text-secondary)" data-lang-key="join-community">
          Join our community
        </div>
      </div>
    </a>

    <a href="https://github.com/nebura-dev" class="support-link" target="_blank">
      <div class="support-icon github-icon">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
          <path
            d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"
          />
        </svg>
      </div>
      <div>
        <div style="font-weight: 500" data-lang-key="github-repo">GitHub Repository</div>
        <div style="font-size: 12px; color: var(--text-secondary)" data-lang-key="open-source">
          Open source and contributions
        </div>
      </div>
    </a>

    <a href="https://t.me/nebura_support" class="support-link" target="_blank">
      <div class="support-icon telegram-icon">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
          <path
            d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"
          />
        </svg>
      </div>
      <div>
        <div style="font-weight: 500" data-lang-key="telegram-support">Telegram Support</div>
        <div style="font-size: 12px; color: var(--text-secondary)" data-lang-key="instant-help">Instant help 24/7</div>
      </div>
    </a>
  </div>

  <!-- Ticket System Grid -->
  <div class="ticket-system-grid" style="display: grid; grid-template-columns: 1fr 1.2fr; gap: 32px; margin-top: 32px;">
    <!-- Create New Ticket (Left) -->
    <div
      class="dashboard-card ticket-create-card"
      style="background: var(--secondary-bg); box-shadow: 0 2px 8px var(--shadow-light);"
    >
      <h3 style="font-size: 18px; font-weight: 700; margin-bottom: 15px;">
        üé´ Create New Ticket
      </h3>
      <form id="ticketForm" enctype="multipart/form-data" style="display: grid; gap: 14px;">
        <div class="form-group">
          <label for="ticketCategory" style="font-weight: 500;">Category</label>
          <select id="ticketCategory" name="category" class="control-select ticket-select" required>
            <option value="">Select...</option>
            <option value="Technical Support">Technical Support</option>
            <option value="Billing">Billing</option>
            <option value="Suggestions">Suggestions</option>
            <option value="Security">Security</option>
          </select>
        </div>
        <div class="form-group">
          <label for="ticketPriority" style="font-weight: 500;">Priority</label>
          <select id="ticketPriority" name="priority" class="control-select ticket-select" required>
            <option value="low">Low</option>
            <option value="medium">Medium</option>
            <option value="high">High</option>
            <option value="critical">Critical</option>
          </select>
        </div>
        <div class="form-group">
          <label for="ticketTitle" style="font-weight: 500;">Title</label>
          <input type="text" id="ticketTitle" name="title" class="control-input ticket-input" required maxlength="80" />
        </div>
        <div class="form-group">
          <label for="ticketDescription" style="font-weight: 500;">Description</label>
          <textarea id="ticketDescription" name="description" class="control-input ticket-input" rows="3" required></textarea>
        </div>
        <div class="form-group">
          <label for="ticketLinks" style="font-weight: 500;">Attached Links</label>
          <input type="text" id="ticketLinks" name="links" class="control-input ticket-input" placeholder="https://..." />
        </div>
        <div class="form-group">
          <label for="ticketFiles" style="font-weight: 500;">Attach Files</label>
          <input type="file" id="ticketFiles" name="files" multiple accept=".jpg,.png,.pdf,.log,.txt,.jpeg" />
        </div>
        <div style="display: flex; gap: 16px;">
          <label><input type="checkbox" name="urgent" /> Requires urgent response</label>
          <label><input type="checkbox" name="evidence" /> Evidence attached</label>
        </div>
        <button type="submit" class="run-btn" style="margin-top: 8px;">Submit Ticket</button>
      </form>
      <div id="ticketFormFeedback" style="margin-top: 8px; font-size: 13px;"></div>
    </div>

    <!-- My Tickets (Right) -->
    <div
      class="dashboard-card ticket-list-card"
      style="background: var(--secondary-bg); box-shadow: 0 2px 8px var(--shadow-light);"
    >
      <h3 style="font-size: 17px; font-weight: 700; margin-bottom: 10px;">
        üóÇÔ∏è My Tickets
      </h3>
      <div style="margin-bottom: 10px; display: flex; gap: 12px; flex-wrap: wrap;">
        <select id="ticketFilterStatus" class="control-select ticket-select" style="max-width: 160px;">
          <option value="">All statuses</option>
          <option value="open">Open</option>
          <option value="in_progress">In Progress</option>
          <option value="waiting_user">Waiting for User</option>
          <option value="closed">Closed</option>
        </select>
        <select id="ticketFilterPriority" class="control-select ticket-select" style="max-width: 160px;">
          <option value="">All priorities</option>
          <option value="low">Low</option>
          <option value="medium">Medium</option>
          <option value="high">High</option>
          <option value="critical">Critical</option>
        </select>
        <input type="date" id="ticketFilterDate" class="control-input ticket-input" style="max-width: 160px;" />
      </div>
      <div id="userTicketsPanel">
        <table class="ticket-table">
          <thead>
            <tr>
              <th>#</th>
              <th>Title</th>
              <th>Category</th>
              <th>Priority</th>
              <th>Status</th>
              <th>Created</th>
              <th>Last Update</th>
            </tr>
          </thead>
          <tbody>
            {{#each userTickets}}
              <tr class="ticket-row" onclick="selectTicket('{{id}}')" style="cursor:pointer;">
                <td style="font-weight:600;">{{id}}</td>
                <td style="color:var(--nebura-purple); font-weight:500;">{{title}}</td>
                <td>{{category}}</td>
                <td>{{priority}}</td>
                <td>
                  <span class="ticket-status ticket-status-{{status}}" style="font-size:12px; font-weight:600;">
                    {{status}}
                  </span>
                </td>
                <td>{{createdAt}}</td>
                <td>{{updatedAt}}</td>
              </tr>
            {{/each}}
            {{#unless userTickets.length}}
              <tr>
                <td colspan="7" style="text-align:center; color:var(--text-secondary); padding:12px;">
                  You have no tickets created.
                </td>
              </tr>
            {{/unless}}
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Ticket Details Panel (Below both sections) -->
  <div id="ticketDetailsPanel" class="dashboard-card ticket-details-card" style="display:none; margin-top:24px;">
    <!-- Content rendered by JS -->
  </div>

  <!-- Ticket Chat Interface (Discord Style) -->
  <div id="ticketChatModal" class="dashboard-card ticket-chat-card" style="display:none; margin-top:24px;">
    <div class="chat-header" style="display:flex; align-items:center; justify-content:space-between; margin-bottom:10px;">
      <div style="display:flex; align-items:center; gap:10px;">
        <div class="card-icon" style="width:32px; height:32px;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15h2v-2h-2v2zm0-4h2V7h-2v6z" />
          </svg>
        </div>
        <h3 id="ticketChatTitle" style="font-size:17px; font-weight:700; color:var(--nebura-purple); margin:0;">
          Ticket Chat
        </h3>
        <span id="ticketChatId" style="font-size:13px; color:var(--text-secondary); margin-left:8px;"></span>
      </div>
      <div style="display:flex; gap:10px;">
        <button
          class="run-btn close-chat-btn"
          onclick="closeTicketChat()"
          title="Close Chat"
          style="background:var(--gradient-secondary); min-width:40px; max-width:40px; height:40px; padding:0; display:flex; align-items:center; justify-content:center; border-radius:8px;"
        >
          <svg width="18" height="18" style="vertical-align:middle;" fill="currentColor">
            <circle cx="9" cy="9" r="8" />
            <line x1="6" y1="6" x2="12" y2="12" stroke="white" stroke-width="2" />
            <line x1="12" y1="6" x2="6" y2="12" stroke="white" stroke-width="2" />
          </svg>
        </button>
        <button
          id="ticketChatReloadBtn"
          class="run-btn"
          onclick="window.ticketReloadChat && ticketReloadChat()"
          title="Reload Chat"
          style="background:var(--nebura-purple); min-width:40px; max-width:40px; height:40px; padding:0; display:flex; align-items:center; justify-content:center; border-radius:8px;"
        >
          <svg width="18" height="18" style="vertical-align:middle;" fill="currentColor">
            <path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.1-.9 2-2 2h-1v2h1c2.21 0 4-1.79 4-4 0-4.42-3.58-8-8-8z" />
          </svg>
        </button>
      </div>
    </div>
    <div
      id="ticketChatMessages"
      style="max-height:320px; overflow-y:auto; margin:16px 0; background:var(--primary-bg); border-radius:8px; padding:12px;"
    >
      <!-- Messages rendered here by JS -->
    </div>
    <form
      id="ticketChatForm"
      enctype="multipart/form-data"
      style="display: flex; gap: 12px; align-items: center; margin-top: 8px;"
    >
      <!-- √Årea visual para archivos adjuntos -->
      <div
        id="chatFilesPreview"
        style="min-width:90px; max-width:120px; height:40px; background:var(--accent-bg); border-radius:8px; display:flex; align-items:center; justify-content:center; color:var(--nebura-purple); font-size:13px; font-weight:500; border:1.5px solid var(--border-color); overflow-x:auto; padding:0 6px;"
      >
        <span id="chatFilesLabel" style="white-space:nowrap;">No files</span>
      </div>
      <!-- Bot√≥n de adjuntar archivos -->
      <label for="chatFiles" class="chat-file-label" style="margin-bottom:0;">
        <input
          type="file"
          id="chatFiles"
          name="chatFiles"
          multiple
          accept=".jpg,.png,.pdf,.log,.txt,.jpeg"
          class="ticket-chat-file"
          style="display:none;"
          onchange="updateChatFilesLabel()"
        />
        <span
          class="run-btn"
          style="padding:8px 22px; min-width:110px; background:var(--gradient-accent); color:white; font-size:13px; font-weight:500; cursor:pointer; border-radius:8px; display:inline-block;"
        >üìé Attach</span>
      </label>
      <!-- Input de mensaje -->
      <input type="text" name="message" class="control-input" placeholder="Type your message..." required style="flex:1;" />
      <!-- Bot√≥n de enviar -->
      <button type="submit" class="run-btn" style="min-width:70px; max-width:90px; padding:8px 0;">Send</button>
    </form>
    <div id="ticketChatFeedback" style="margin-top:8px; font-size:13px;"></div>
  </div>
</div>
<script>
  function updateChatFilesLabel() {
    const input = document.getElementById('chatFiles');
    const label = document.getElementById('chatFilesLabel');
    if (input.files.length === 0) {
      label.textContent = 'No files';
    } else {
      label.textContent = Array.from(input.files)
        .map(f => f.name)
        .join(', ');
    }
  }
</script>