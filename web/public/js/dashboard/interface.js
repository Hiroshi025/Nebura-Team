// Enhanced Language translations
const translations = {
  es: {
    logo: "NEBURA",
    main: "PRINCIPAL",
    dashboard: "Dashboard",
    analytics: "An√°lisis",
    reports: "Reportes",
    "daily-reports": "Reportes Diarios",
    "monthly-reports": "Reportes Mensuales",
    "custom-reports": "Reportes Personalizados",
    api: "API y DESARROLLO",
    examples: "Ejemplos",
    docs: "Documentaci√≥n",
    "api-reference": "Referencia API",
    "sdk-docs": "SDK Documentation",
    tutorials: "Tutoriales",
    changelog: "Changelog",
    account: "CUENTA",
    profile: "Perfil",
    licenses: "Licencias",
    activity: "Actividad",
    settings: "Configuraci√≥n",
    "account-settings": "Configuraci√≥n de Cuenta",
    "api-keys": "Claves API",
    security: "Seguridad",
    support: "SOPORTE",
    help: "Ayuda",
    search: "Buscar por tags, categor√≠as, relaciones...",
    "search-tip": "Tip: Usa # para tags, @ para categor√≠as",
    theme: "üåô Oscuro",
    copy: "Copiar",
    download: "Descargar",
    "update-code": "Actualizar C√≥digo",
    "api-endpoint": "Endpoint API",
    category: "Categor√≠a",
    "api-key": "API Key",
    "base-url": "Base URL",
    "api-calls": "Llamadas API",
    "monthly-calls": "Llamadas este mes",
    "active-users": "Usuarios Activos",
    "registered-users": "Usuarios Registrados",
    "anime-database": "Base de Datos",
    "anime-entries": "Entradas de Anime",
    "system-status": "Estado del Sistema",
    uptime: "Tiempo de Actividad",
    "temporal-analysis": "AN√ÅLISIS TEMPORAL NEBURA",
    "loading-chart": "Cargando an√°lisis avanzado...",
    "code-examples": "EJEMPLOS DE C√ìDIGO API",
    "user-profile": "PERFIL DE USUARIO",
    "user-details": "Detalles del Usuario",
    "discord-integration": "Integraci√≥n Discord",
    "discord-details": "Detalles Discord",
    connected: "‚úì Conectado y Verificado",
    "license-management": "GESTI√ìN DE LICENCIAS",
    "activity-history": "HISTORIAL DE ACTIVIDAD",
    "recent-activity": "Actividad Reciente",
    "all-activity": "Toda la Actividad",
    clear: "Limpiar",
    "clear-all": "Limpiar Todo",
    "support-center": "CENTRO DE SOPORTE",
    "discord-server": "Servidor Discord",
    "join-community": "√önete a nuestra comunidad",
    "github-repo": "Repositorio GitHub",
    "open-source": "C√≥digo abierto y contribuciones",
    "telegram-support": "Soporte Telegram",
    "instant-help": "Ayuda instant√°nea 24/7",
    projects: "Proyectos",
    "member-since": "Miembro",
  },
  en: {
    logo: "NEBURA",
    main: "MAIN",
    dashboard: "Dashboard",
    analytics: "Analytics",
    reports: "Reports",
    "daily-reports": "Daily Reports",
    "monthly-reports": "Monthly Reports",
    "custom-reports": "Custom Reports",
    api: "API and DEVELOPMENT",
    examples: "Examples",
    docs: "Documentation",
    "api-reference": "API Reference",
    "sdk-docs": "SDK Documentation",
    tutorials: "Tutorials",
    changelog: "Changelog",
    account: "ACCOUNT",
    profile: "Profile",
    licenses: "Licenses",
    activity: "Activity",
    settings: "Settings",
    "account-settings": "Account Settings",
    "api-keys": "API Keys",
    security: "Security",
    support: "SUPPORT",
    help: "Help",
    search: "Search by tags, categories, relations...",
    "search-tip": "Tip: Use # for tags, @ for categories",
    theme: "üåô Dark",
    copy: "Copy",
    download: "Download",
    "update-code": "Update Code",
    "api-endpoint": "API Endpoint",
    category: "Category",
    "api-key": "API Key",
    "base-url": "Base URL",
    "api-calls": "API Calls",
    "monthly-calls": "Calls this month",
    "active-users": "Active Users",
    "registered-users": "Registered Users",
    "anime-database": "Anime Database",
    "anime-entries": "Anime Entries",
    "system-status": "System Status",
    uptime: "Uptime",
    "temporal-analysis": "NEBURA TEMPORAL ANALYSIS",
    "loading-chart": "Loading advanced analysis...",
    "code-examples": "API CODE EXAMPLES",
    "user-profile": "USER PROFILE",
    "user-details": "User Details",
    "discord-integration": "Discord Integration",
    "discord-details": "Discord Details",
    connected: "‚úì Connected and Verified",
    "license-management": "LICENSE MANAGEMENT",
    "activity-history": "ACTIVITY HISTORY",
    "recent-activity": "Recent Activity",
    "all-activity": "All Activity",
    clear: "Clear",
    "clear-all": "Clear All",
    "support-center": "SUPPORT CENTER",
    "discord-server": "Discord Server",
    "join-community": "Join our community",
    "github-repo": "GitHub Repository",
    "open-source": "Open source and contributions",
    "telegram-support": "Telegram Support",
    "instant-help": "Instant help 24/7",
    projects: "Projects",
    "member-since": "Member",
  },
  ja: {
    logo: "NEBURA",
    main: "„É°„Ç§„É≥",
    dashboard: "„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ",
    analytics: "ÂàÜÊûê",
    reports: "„É¨„Éù„Éº„Éà",
    "daily-reports": "Êó•Ê¨°„É¨„Éù„Éº„Éà",
    "monthly-reports": "ÊúàÊ¨°„É¨„Éù„Éº„Éà",
    "custom-reports": "„Ç´„Çπ„Çø„É†„É¨„Éù„Éº„Éà",
    api: "API & ÈñãÁô∫",
    examples: "‰æã",
    docs: "„Éâ„Ç≠„É•„É°„É≥„Éà",
    "api-reference": "API„É™„Éï„Ç°„É¨„É≥„Çπ",
    "sdk-docs": "SDK„Éâ„Ç≠„É•„É°„É≥„Éà",
    tutorials: "„ÉÅ„É•„Éº„Éà„É™„Ç¢„É´",
    changelog: "Â§âÊõ¥Â±•Ê≠¥",
    account: "„Ç¢„Ç´„Ç¶„É≥„Éà",
    profile: "„Éó„É≠„Éï„Ç£„Éº„É´",
    licenses: "„É©„Ç§„Çª„É≥„Çπ",
    activity: "„Ç¢„ÇØ„ÉÜ„Ç£„Éì„ÉÜ„Ç£",
    settings: "Ë®≠ÂÆö",
    "account-settings": "„Ç¢„Ç´„Ç¶„É≥„ÉàË®≠ÂÆö",
    "api-keys": "API„Ç≠„Éº",
    security: "„Çª„Ç≠„É•„É™„ÉÜ„Ç£",
    support: "„Çµ„Éù„Éº„Éà",
    help: "„Éò„É´„Éó",
    search: "„Çø„Ç∞„ÄÅ„Ç´„ÉÜ„Ç¥„É™„ÄÅÈñ¢‰øÇ„ÅßÊ§úÁ¥¢...",
    "search-tip": "„Éí„É≥„Éà: „Çø„Ç∞„Å´„ÅØ#„ÄÅ„Ç´„ÉÜ„Ç¥„É™„Å´„ÅØ@„Çí‰ΩøÁî®",
    theme: "üåô „ÉÄ„Éº„ÇØ",
    copy: "„Ç≥„Éî„Éº",
    download: "„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ",
    "update-code": "„Ç≥„Éº„ÉâÊõ¥Êñ∞",
    "api-endpoint": "API„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà",
    category: "„Ç´„ÉÜ„Ç¥„É™",
    "api-key": "API„Ç≠„Éº",
    "base-url": "„Éô„Éº„ÇπURL",
    "api-calls": "APIÂëº„Å≥Âá∫„Åó",
    "monthly-calls": "‰ªäÊúà„ÅÆÂëº„Å≥Âá∫„Åó",
    "active-users": "„Ç¢„ÇØ„ÉÜ„Ç£„Éñ„É¶„Éº„Ç∂„Éº",
    "registered-users": "ÁôªÈå≤„É¶„Éº„Ç∂„Éº",
    "anime-database": "„Ç¢„Éã„É°„Éá„Éº„Çø„Éô„Éº„Çπ",
    "anime-entries": "„Ç¢„Éã„É°„Ç®„É≥„Éà„É™",
    "system-status": "„Ç∑„Çπ„ÉÜ„É†Áä∂ÊÖã",
    uptime: "Á®ºÂÉçÊôÇÈñì",
    "temporal-analysis": "NEBURAÊôÇÁ≥ªÂàóÂàÜÊûê",
    "loading-chart": "È´òÂ∫¶„Å™ÂàÜÊûê„ÇíË™≠„ÅøËæº„Åø‰∏≠...",
    "code-examples": "API„Ç≥„Éº„Éâ‰æã",
    "user-profile": "„É¶„Éº„Ç∂„Éº„Éó„É≠„Éï„Ç£„Éº„É´",
    "user-details": "„É¶„Éº„Ç∂„ÉºË©≥Á¥∞",
    "discord-integration": "DiscordÁµ±Âêà",
    "discord-details": "DiscordË©≥Á¥∞",
    connected: "‚úì Êé•Á∂öÊ∏à„Åø„ÉªË™çË®ºÊ∏à„Åø",
    "license-management": "„É©„Ç§„Çª„É≥„ÇπÁÆ°ÁêÜ",
    "activity-history": "„Ç¢„ÇØ„ÉÜ„Ç£„Éì„ÉÜ„Ç£Â±•Ê≠¥",
    "recent-activity": "ÊúÄËøë„ÅÆ„Ç¢„ÇØ„ÉÜ„Ç£„Éì„ÉÜ„Ç£",
    "all-activity": "„Åô„Åπ„Å¶„ÅÆ„Ç¢„ÇØ„ÉÜ„Ç£„Éì„ÉÜ„Ç£",
    clear: "„ÇØ„É™„Ç¢",
    "clear-all": "„Åô„Åπ„Å¶„ÇØ„É™„Ç¢",
    "support-center": "„Çµ„Éù„Éº„Éà„Çª„É≥„Çø„Éº",
    "discord-server": "Discord„Çµ„Éº„Éê„Éº",
    "join-community": "„Ç≥„Éü„É•„Éã„ÉÜ„Ç£„Å´ÂèÇÂä†",
    "github-repo": "GitHub„É™„Éù„Ç∏„Éà„É™",
    "open-source": "„Ç™„Éº„Éó„É≥„ÇΩ„Éº„Çπ„Å®Ë≤¢ÁåÆ",
    "telegram-support": "Telegram„Çµ„Éù„Éº„Éà",
    "instant-help": "24/7Âç≥Â∫ß„ÅÆ„Éò„É´„Éó",
    projects: "„Éó„É≠„Ç∏„Çß„ÇØ„Éà",
    "member-since": "„É°„É≥„Éê„ÉºÈñãÂßã",
  },
};

// Code examples for different languages
// ...existing code...
const codeExamples = {
  javascript: (apiKey, baseUrl, endpoint, identifier) => `// JavaScript - Consumir API de Playground (Validaci√≥n de Licencia)
const BASE_URL = '${baseUrl || "https://tudominio.com/api/v1"}';
const LICENSE_KEY = '${apiKey || "TU_CLAVE_DE_LICENCIA"}';
const IDENTIFIER = '${identifier || "TU_IDENTIFICADOR"}';

async function validateLicense() {
  const url = \`\${BASE_URL}/validate-licence?key=\${encodeURIComponent(LICENSE_KEY)}&identifier=\${encodeURIComponent(IDENTIFIER)}\`;
  const response = await fetch(url, {
    method: 'GET',
    headers: {
      'Authorization': 'Bearer ' + LICENSE_KEY,
      'Content-Type': 'application/json'
    }
  });
  if (!response.ok) throw new Error(\`HTTP error: \${response.status}\`);
  const data = await response.json();
  return data;
}

// Uso del ejemplo
validateLicense()
  .then(data => console.log('Respuesta:', data))
  .catch(err => console.error('Error:', err));
`,

  typescript: (apiKey, baseUrl, endpoint, identifier) => `// TypeScript - Consumir API de Playground (Validaci√≥n de Licencia)
interface PlaygroundResponse {
  valid: boolean;
  message: string;
  [key: string]: any;
}

const BASE_URL = '${baseUrl || "https://tudominio.com/api/v1"}';
const LICENSE_KEY = '${apiKey || "TU_CLAVE_DE_LICENCIA"}';
const IDENTIFIER = '${identifier || "TU_IDENTIFICADOR"}';

async function validateLicense(): Promise<PlaygroundResponse> {
  const url = \`\${BASE_URL}/validate-licence?key=\${encodeURIComponent(LICENSE_KEY)}&identifier=\${encodeURIComponent(IDENTIFIER)}\`;
  const response = await fetch(url, {
    method: 'GET',
    headers: {
      'Authorization': 'Bearer ' + LICENSE_KEY,
      'Content-Type': 'application/json'
    }
  });
  if (!response.ok) throw new Error(\`HTTP error: \${response.status}\`);
  return await response.json();
}

// Uso del ejemplo
validateLicense()
  .then(data => console.log('Respuesta:', data))
  .catch(err => console.error('Error:', err));
`,

  python: (apiKey, baseUrl, endpoint, identifier) => `# Python - Consumir API de Playground (Validaci√≥n de Licencia)
import requests

BASE_URL = '${baseUrl || "https://tudominio.com/api/v1"}'
LICENSE_KEY = '${apiKey || "TU_CLAVE_DE_LICENCIA"}'
IDENTIFIER = '${identifier || "TU_IDENTIFICADOR"}'

def validate_license():
    url = f"{BASE_URL}/validate-licence?key={LICENSE_KEY}&identifier={IDENTIFIER}"
    headers = {
        "Authorization": f"Bearer {LICENSE_KEY}",
        "Content-Type": "application/json"
    }
    response = requests.get(url, headers=headers)
    response.raise_for_status()
    return response.json()

# Uso del ejemplo
if __name__ == "__main__":
    try:
        data = validate_license()
        print("Respuesta:", data)
    except Exception as e:
        print("Error:", e)
`,

  go: (apiKey, baseUrl, endpoint, identifier) => `// Go - Consumir API de Playground (Validaci√≥n de Licencia)
package main

import (
  "encoding/json"
  "fmt"
  "net/http"
  "os"
)

func main() {
  baseUrl := "${baseUrl || "https://tudominio.com/api/v1"}"
  licenseKey := "${apiKey || "TU_CLAVE_DE_LICENCIA"}"
  identifier := "${identifier || "TU_IDENTIFICADOR"}"
  url := fmt.Sprintf("%s/validate-licence?key=%s&identifier=%s", baseUrl, licenseKey, identifier)

  req, _ := http.NewRequest("GET", url, nil)
  req.Header.Set("Authorization", "Bearer "+licenseKey)
  req.Header.Set("Content-Type", "application/json")

  resp, err := http.DefaultClient.Do(req)
  if err != nil {
    fmt.Println("Error:", err)
    os.Exit(1)
  }
  defer resp.Body.Close()

  var result map[string]interface{}
  json.NewDecoder(resp.Body).Decode(&result)
  fmt.Println("Respuesta:", result)
}
`,

  rust: (apiKey, baseUrl, endpoint, identifier) => `// Rust - Consumir API de Playground (Validaci√≥n de Licencia)
use reqwest::header::{HeaderMap, HeaderValue, AUTHORIZATION, CONTENT_TYPE};
use std::error::Error;

#[tokio::main]
async fn main() -> Result<(), Box<dyn Error>> {
    let base_url = "${baseUrl || "https://tudominio.com/api/v1"}";
    let license_key = "${apiKey || "TU_CLAVE_DE_LICENCIA"}";
    let identifier = "${identifier || "TU_IDENTIFICADOR"}";
    let url = format!("{}/validate-licence?key={}&identifier={}", base_url, license_key, identifier);

    let mut headers = HeaderMap::new();
    headers.insert(AUTHORIZATION, HeaderValue::from_str(&format!("Bearer {}", license_key))?);
    headers.insert(CONTENT_TYPE, HeaderValue::from_static("application/json"));

    let client = reqwest::Client::new();
    let resp = client.get(&url).headers(headers).send().await?;
    let json: serde_json::Value = resp.json().await?;
    println!("Respuesta: {}", json);
    Ok(())
}
`,

  java: (apiKey, baseUrl, endpoint, identifier) => `// Java - Consumir API de Playground (Validaci√≥n de Licencia)
import java.net.URI;
import java.net.http.*;
import java.util.*;

public class PlaygroundApiExample {
    public static void main(String[] args) throws Exception {
        String baseUrl = "${baseUrl || "https://tudominio.com/api/v1"}";
        String licenseKey = "${apiKey || "TU_CLAVE_DE_LICENCIA"}";
        String identifier = "${identifier || "TU_IDENTIFICADOR"}";
        String url = baseUrl + "/validate-licence?key=" + licenseKey + "&identifier=" + identifier;

        HttpClient client = HttpClient.newHttpClient();
        HttpRequest request = HttpRequest.newBuilder()
            .uri(URI.create(url))
            .header("Authorization", "Bearer " + licenseKey)
            .header("Content-Type", "application/json")
            .GET()
            .build();

        HttpResponse<String> response = client.send(request, HttpResponse.BodyHandlers.ofString());
        System.out.println("Respuesta: " + response.body());
    }
}
`,

  cpp: (apiKey, baseUrl, endpoint, identifier) => `// C++ - Consumir API de Playground (Validaci√≥n de Licencia)
#include <iostream>
#include <string>
#include <curl/curl.h>

size_t WriteCallback(void* contents, size_t size, size_t nmemb, std::string* out) {
    size_t total = size * nmemb;
    out->append((char*)contents, total);
    return total;
}

int main() {
    CURL* curl = curl_easy_init();
    if (!curl) return 1;

    std::string baseUrl = "${baseUrl || "https://tudominio.com/api/v1"}";
    std::string licenseKey = "${apiKey || "TU_CLAVE_DE_LICENCIA"}";
    std::string identifier = "${identifier || "TU_IDENTIFICADOR"}";
    std::string url = baseUrl + "/validate-licence?key=" + licenseKey + "&identifier=" + identifier;

    struct curl_slist* headers = NULL;
    std::string auth = "Authorization: Bearer " + licenseKey;
    headers = curl_slist_append(headers, auth.c_str());
    headers = curl_slist_append(headers, "Content-Type: application/json");

    std::string response;
    curl_easy_setopt(curl, CURLOPT_URL, url.c_str());
    curl_easy_setopt(curl, CURLOPT_HTTPHEADER, headers);
    curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, WriteCallback);
    curl_easy_setopt(curl, CURLOPT_WRITEDATA, &response);

    CURLcode res = curl_easy_perform(curl);
    curl_slist_free_all(headers);
    curl_easy_cleanup(curl);

    if (res == CURLE_OK)
        std::cout << "Respuesta: " << response << std::endl;
    else
        std::cerr << "Error en la petici√≥n" << std::endl;

    return 0;
}
`,

  c: (apiKey, baseUrl, endpoint, identifier) => `// C - Consumir API de Playground (Validaci√≥n de Licencia)
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <curl/curl.h>

struct string {
    char* ptr;
    size_t len;
};

void init_string(struct string* s) {
    s->len = 0;
    s->ptr = malloc(1);
    s->ptr[0] = '\\0';
}

size_t writefunc(void* ptr, size_t size, size_t nmemb, struct string* s) {
    size_t new_len = s->len + size * nmemb;
    s->ptr = realloc(s->ptr, new_len + 1);
    memcpy(s->ptr + s->len, ptr, size * nmemb);
    s->ptr[new_len] = '\\0';
    s->len = new_len;
    return size * nmemb;
}

int main() {
    CURL* curl = curl_easy_init();
    if (!curl) return 1;

    const char* baseUrl = "${baseUrl || "https://tudominio.com/api/v1"}";
    const char* licenseKey = "${apiKey || "TU_CLAVE_DE_LICENCIA"}";
    const char* identifier = "${identifier || "TU_IDENTIFICADOR"}";
    char url[512];
    snprintf(url, sizeof(url), "%s/validate-licence?key=%s&identifier=%s", baseUrl, licenseKey, identifier);

    struct curl_slist* headers = NULL;
    char auth[256];
    snprintf(auth, sizeof(auth), "Authorization: Bearer %s", licenseKey);
    headers = curl_slist_append(headers, auth);
    headers = curl_slist_append(headers, "Content-Type: application/json");

    struct string s;
    init_string(&s);

    curl_easy_setopt(curl, CURLOPT_URL, url);
    curl_easy_setopt(curl, CURLOPT_HTTPHEADER, headers);
    curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, writefunc);
    curl_easy_setopt(curl, CURLOPT_WRITEDATA, &s);

    CURLcode res = curl_easy_perform(curl);
    curl_slist_free_all(headers);
    curl_easy_cleanup(curl);

    if (res == CURLE_OK)
        printf("Respuesta: %s\\n", s.ptr);
    else
        printf("Error en la petici√≥n\\n");

    free(s.ptr);
    return 0;
}
`,
};
// ...existing code...

// Initialize the page
document.addEventListener("DOMContentLoaded", function () {
  // Initialize particles
  createParticles();

  // Initialize sidebar toggle
  const sidebar = document.getElementById("sidebar");
  const sidebarToggle = document.getElementById("sidebarToggle");
  const header = document.getElementById("header");
  const mainContent = document.getElementById("mainContent");

  sidebarToggle.addEventListener("click", function () {
    sidebar.classList.toggle("collapsed");
    header.classList.toggle("sidebar-collapsed");
    mainContent.classList.toggle("sidebar-collapsed");
  });

  // Initialize dropdown toggles
  const dropdownToggles = document.querySelectorAll(".dropdown-toggle");
  dropdownToggles.forEach((toggle) => {
    toggle.addEventListener("click", function (e) {
      e.preventDefault();
      this.classList.toggle("expanded");
      const dropdown = this.nextElementSibling;
      dropdown.classList.toggle("show");
    });
  });

  // Inicializa navegaci√≥n de p√°ginas con validaci√≥n de admin
  const navLinks = document.querySelectorAll(".nav-link:not(.dropdown-toggle)");
  navLinks.forEach((link) => {
    link.addEventListener("click", async function (e) {
      e.preventDefault();
      const pageId = this.getAttribute("data-page");

      if (pageId === "administration") {
        // Validar si el usuario es admin antes de mostrar la secci√≥n
        try {
          const res = await fetch("/dashboard/utils/is-admin");
          const isAdmin = await res.json();
          if (isAdmin === true) {
            showPage(pageId);
            navLinks.forEach((l) => l.classList.remove("active"));
            this.classList.add("active");
          } else {
            alert("Hello, not an admin user and you cannot access this section.");
          }
        } catch (err) {
          console.log(err);
        }
      } else {
        showPage(pageId);
        navLinks.forEach((l) => l.classList.remove("active"));
        this.classList.add("active");
      }
    });
  });

  // Initialize search functionality
  const searchInput = document.getElementById("searchInput");
  const searchFilters = document.getElementById("searchFilters");

  searchInput.addEventListener("focus", function () {
    searchFilters.classList.add("show");
  });

  searchInput.addEventListener("blur", function () {
    setTimeout(() => {
      searchFilters.classList.remove("show");
    }, 200);
  });

  // Initialize filter tags
  const filterTags = document.querySelectorAll(".filter-tag");
  filterTags.forEach((tag) => {
    tag.addEventListener("click", function () {
      const filter = this.getAttribute("data-filter");
      searchInput.value = `#${filter} `;
      searchInput.focus();
    });
  });

  // Initialize theme toggle
  const themeToggle = document.getElementById("themeToggle");
  themeToggle.addEventListener("click", function () {
    const html = document.documentElement;
    const currentTheme = html.getAttribute("data-theme");
    const newTheme = currentTheme === "dark" ? "light" : "dark";
    html.setAttribute("data-theme", newTheme);

    // Update button text
    const themeText = newTheme === "dark" ? "üåô Oscuro" : "‚òÄÔ∏è Claro";
    this.querySelector("span").textContent = themeText;
    this.querySelector("span").setAttribute("data-lang-key", "theme");
    updateLanguageText();
  });

  // Desactivar selector de idioma
  /*
  // Initialize language selector
  const langToggle = document.getElementById("langToggle");
  const langDropdown = document.getElementById("langDropdown");
  const currentLang = document.getElementById("currentLang");

  langToggle.addEventListener("click", function (e) {
    e.stopPropagation();
    langDropdown.classList.toggle("show");
  });

  // Close language dropdown when clicking outside
  document.addEventListener("click", function () {
    langDropdown.classList.remove("show");
  });

  // Language selection
  const langOptions = document.querySelectorAll(".lang-option");
  langOptions.forEach((option) => {
    option.addEventListener("click", function () {
      const lang = this.getAttribute("data-lang");
      currentLang.textContent = lang.toUpperCase();
      updateLanguageText(lang);
    });
  });
  */

  // Set initial language (desactivado)
  // updateLanguageText("es");
});

// Show specific page
function showPage(pageId) {
  const pages = document.querySelectorAll(".page-section");
  pages.forEach((page) => {
    page.classList.remove("active");
    if (page.id === pageId) {
      page.classList.add("active");
    }
  });
}

// Create floating particles
function createParticles() {
  const particlesContainer = document.getElementById("particles");
  const particleCount = 30;

  for (let i = 0; i < particleCount; i++) {
    const particle = document.createElement("div");
    particle.classList.add("particle");

    // Random position
    const posX = Math.random() * 100;
    const delay = Math.random() * 20;

    particle.style.left = `${posX}%`;
    particle.style.animationDelay = `${delay}s`;

    // Random size
    const size = 1 + Math.random() * 3;
    particle.style.width = `${size}px`;
    particle.style.height = `${size}px`;

    // Random opacity
    const opacity = 0.1 + Math.random() * 0.3;
    particle.style.opacity = opacity;

    particlesContainer.appendChild(particle);
  }
}

// --- DESACTIVAR MULTILENGUAJE ---
// Comentando la funci√≥n de traducci√≥n y sus llamadas

/*
function updateLanguageText(lang = "es") {
  const elements = document.querySelectorAll("[data-lang-key]");
  elements.forEach((el) => {
    const key = el.getAttribute("data-lang-key");
    if (translations[lang] && translations[lang][key]) {
      if (el.tagName === "INPUT" && el.hasAttribute("placeholder")) {
        el.setAttribute("placeholder", translations[lang][key]);
      } else {
        el.textContent = translations[lang][key];
      }
    }
  });
}
*/

// Populate activity history
function populateActivityHistory() {
  const activities = [
    { type: "login", description: "Inicio de sesi√≥n exitoso desde 192.168.1.100", time: "Hace 5 minutos" },
    { type: "api", description: "Llamada API a /anime/waifu/neko", time: "Hace 12 minutos" },
    { type: "profile", description: "Perfil actualizado - Cambio de avatar", time: "Hace 1 hora" },
    { type: "api", description: "Llamada API a /anime/search?q=demon", time: "Hace 2 horas" },
    { type: "api", description: "Llamada API a /anime/character/12345", time: "Hace 3 horas" },
    { type: "login", description: "Intento de inicio de sesi√≥n fallido", time: "Hace 5 horas" },
    { type: "api", description: "Llamada API a /anime/waifu/maid", time: "Hace 1 d√≠a" },
    { type: "profile", description: "Configuraci√≥n de seguridad actualizada", time: "Hace 2 d√≠as" },
  ];

  const activityList = document.getElementById("activityList");
  const fullActivityList = document.getElementById("fullActivityList");

  // Add recent activities (first 5)
  activities.slice(0, 5).forEach((activity) => {
    activityList.appendChild(createActivityItem(activity));
  });

  // Add all activities
  activities.forEach((activity) => {
    fullActivityList.appendChild(createActivityItem(activity));
  });
}

// Create activity item
function createActivityItem(activity) {
  const item = document.createElement("div");
  item.className = "activity-item";

  const icon = document.createElement("div");
  icon.className = `activity-icon ${activity.type}`;

  const content = document.createElement("div");
  content.className = "activity-content";

  const desc = document.createElement("div");
  desc.className = "activity-description";
  desc.textContent = activity.description;

  const time = document.createElement("div");
  time.className = "activity-time";
  time.textContent = activity.time;

  content.appendChild(desc);
  content.appendChild(time);

  item.appendChild(icon);
  item.appendChild(content);

  return item;
}

// Clear activity history
function clearActivityHistory() {
  const activityList = document.getElementById("activityList");
  const fullActivityList = document.getElementById("fullActivityList");

  while (activityList.firstChild) {
    activityList.removeChild(activityList.firstChild);
  }

  while (fullActivityList.firstChild) {
    fullActivityList.removeChild(fullActivityList.firstChild);
  }

  // Add empty state
  const emptyState = document.createElement("div");
  emptyState.className = "activity-item";
  emptyState.style.textAlign = "center";
  emptyState.style.padding = "20px";
  emptyState.textContent = "No hay actividad reciente";

  activityList.appendChild(emptyState.cloneNode(true));
  fullActivityList.appendChild(emptyState);
}

// Update code example based on inputs
function updateCodeExample() {
  const apiKey = document.getElementById("apiKeyInput").value;
  const baseUrl = document.getElementById("baseUrlInput").value;
  const endpoint = document.getElementById("apiEndpoint").value;
  const category = document.getElementById("categoryInput").value;

  // Get active language tab
  const activeTab = document.querySelector(".lang-tab.active");
  const lang = activeTab.getAttribute("data-lang");

  // Update code block
  const codeBlock = document.getElementById("codeBlock");
  if (typeof codeExamples[lang] === "function") {
    codeBlock.textContent = codeExamples[lang](apiKey, baseUrl, endpoint, category);
    codeBlock.className = `language-${lang}`;
    Prism.highlightElement(codeBlock);
  } else {
    codeBlock.textContent = "// No hay ejemplo para este lenguaje.";
    codeBlock.className = "language-txt";
  }
}

// Copy code to clipboard
function copyCode() {
  const codeBlock = document.getElementById("codeBlock");
  const range = document.createRange();
  range.selectNode(codeBlock);
  window.getSelection().removeAllRanges();
  window.getSelection().addRange(range);
  document.execCommand("copy");
  window.getSelection().removeAllRanges();

  // Show feedback
  alert("¬°C√≥digo copiado al portapapeles!");
}

// Download code as file
function downloadCode() {
  const codeBlock = document.getElementById("codeBlock");
  const activeTab = document.querySelector(".lang-tab.active");
  const lang = activeTab.getAttribute("data-lang");

  let extension = "";
  switch (lang) {
    case "javascript":
      extension = "js";
      break;
    case "typescript":
      extension = "ts";
      break;
    case "python":
      extension = "py";
      break;
    case "go":
      extension = "go";
      break;
    case "rust":
      extension = "rs";
      break;
    case "java":
      extension = "java";
      break;
    case "cpp":
      extension = "cpp";
      break;
    case "c":
      extension = "c";
      break;
    default:
      extension = "txt";
  }

  const blob = new Blob([codeBlock.textContent], { type: "text/plain" });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = `nebura-api-example.${extension}`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

// Copy license key
function copyLicenseKey(element) {
  const key = element.getAttribute("data-key");
  navigator.clipboard.writeText(key).then(() => {
    const feedback = element.querySelector(".copy-feedback");
    feedback.classList.add("show");
    setTimeout(() => {
      feedback.classList.remove("show");
    }, 2000);
  });
}

// Cambiar el lenguaje de ejemplo al hacer clic en la pesta√±a
document.querySelectorAll(".lang-tab").forEach((tab) => {
  tab.addEventListener("click", function () {
    // Quitar la clase active de todas las pesta√±as
    document.querySelectorAll(".lang-tab").forEach((t) => t.classList.remove("active"));
    // Agregar la clase active a la pesta√±a seleccionada
    this.classList.add("active");
    // Actualizar el bloque de c√≥digo
    updateCodeExample();
  });
});
