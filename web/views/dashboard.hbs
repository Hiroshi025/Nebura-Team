 <!-- Notificaciones -->
<div id="dashboardNotifications" class="dashboard-notifications"></div>
<!-- Dashboard Section -->
<div class="page-section active" id="dashboard">
  <div class="dashboard-grid">
    <!-- Stats Cards -->
    <div class="dashboard-card">
      <div class="card-header">
        <div class="card-title" data-lang-key="api-calls">API Calls</div>
        <div class="card-icon">
          <svg width="18" height="18" viewBox="0 0 24 24"
            fill="currentColor">
            <path
              d="M8.5 8.5L12 5l3.5 3.5L12 12l-3.5-3.5zM12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
          </svg>
        </div>
      </div>
      <div class="stat-value">+{{isRequestCount}}</div>
      <div class="stat-label" data-lang-key="monthly-calls">Calls this
        month</div>
      <div class="progress-bar">
        <div class="progress-fill" style="width: 85%"></div>
      </div>
    </div>

    <div class="dashboard-card">
      <div class="card-header">
        <div class="card-title" data-lang-key="active-users">Active
          Users</div>
        <div class="card-icon">
          <svg width="18" height="18" viewBox="0 0 24 24"
            fill="currentColor">
            <path
              d="M16 7c0-2.21-1.79-4-4-4S8 4.79 8 7s1.79 4 4 4 4-1.79 4-4zm-4 6c-2.67 0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4z" />
          </svg>
        </div>
      </div>
      <div class="stat-value">+{{isUsers}}</div>
      <div class="stat-label" data-lang-key="registered-users">Registered
        Users</div>
      <div class="progress-bar">
        <div class="progress-fill" style="width: 75%"></div>
      </div>
    </div>

    <div class="dashboard-card">
      <div class="card-header">
        <div class="card-title"
          data-lang-key="anime-database">Database</div>
        <div class="card-icon">
          <svg width="18" height="18" viewBox="0 0 24 24"
            fill="currentColor">
            <path
              d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
          </svg>
        </div>
      </div>
      <div class="stat-value">{{isDatabase}}</div>
      <div class="stat-label" data-lang-key="anime-entries">Anime
        Entries</div>
      <div class="progress-bar">
        <div class="progress-fill" style="width: 92%"></div>
      </div>
    </div>

    <div class="dashboard-card">
      <div class="card-header">
        <div class="card-title" data-lang-key="system-status">System
          Status</div>
        <div class="card-icon">
          <svg width="18" height="18" viewBox="0 0 24 24"
            fill="currentColor">
            <path
              d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z" />
          </svg>
        </div>
      </div>
      <div class="stat-value">{{isTimeActive}}</div>
      <div class="stat-label" data-lang-key="uptime">Uptime</div>
      <div class="progress-bar">
        <div class="progress-fill" style="width: 99%"></div>
      </div>
    </div>
  </div>

  <!-- Activity History -->
  <div class="activity-history">
    <div class="activity-header">
      <div class="activity-title" data-lang-key="recent-activity">Recent
        Activity</div>
      <button class="clear-history-btn" onclick="clearActivityHistory()"
        data-lang-key="clear">Clear</button>
    </div>
    <div class="activity-list" id="activityList">
      {{#if metricsToClient.length}}
      {{#each metricsToClient}}
      {{#ifCond @index '<' 10}}
      <div class="activity-item"
        style="display: flex; align-items: center; justify-content: space-between;">
        <div
          style="display: flex; align-items: center; gap: 12px; flex: 1;">
          {{!-- Icono por tipo --}}
          {{#if (eq type "login")}}
          <img
            src="https://cdn.discordapp.com/avatars/{{user.discord.id}}/{{user.discord.avatar}}.png"
            class="activity-avatar" alt="avatar">
          {{else if (eq type "profile")}}
          <img
            src="https://cdn.discordapp.com/avatars/{{user.discord.id}}/{{user.discord.avatar}}.png"
            class="activity-avatar" alt="avatar">
          {{else if (gt errors 0)}}
          <div class="activity-icon error">
            <svg viewBox="0 0 24 24" fill="currentColor"><path
                d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" /></svg>
          </div>
          {{else}}
          <div class="activity-icon api">
            <svg viewBox="0 0 24 24" fill="currentColor"><path
                d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z" /></svg>
          </div>
          {{/if}}
          <div class="activity-content" style="flex: 1;">
            <div class="activity-description"
              style="font-size: 15px; font-weight: 600;">
              {{system}}
            </div>
            <div
              style="font-size: 12px; color: var(--text-secondary); margin-bottom: 2px;">
              <span><strong>Client ID:</strong> {{clientId}}</span>
              <span style="margin-left: 10px;"><strong>Endpoint:</strong>
                {{endpoint}}</span>
            </div>
            <div style="font-size: 12px; color: var(--text-secondary);">
              <strong>Requests:</strong> {{requests}}
              {{#if (gt errors 0)}}
              <span class="activity-badge">Errors: {{errors}}</span>
              {{else}}
              | <strong>Errors:</strong> {{errors}}
              {{/if}}
            </div>
          </div>
        </div>
        <div
          style="font-size: 13px; color: var(--nebura-purple); font-weight: 600; min-width: 80px; text-align: right;">
          <span title="Latency"><svg
              style="vertical-align: middle; width: 15px; height: 15px; margin-right: 3px;"
              viewBox="0 0 24 24" fill="currentColor"><path
                d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z" /></svg></span>
          {{latency}} ms
        </div>
      </div>
      {{/ifCond}}
      {{/each}}
      {{else}}
      <div class="activity-item" style="text-align:center;padding:20px;">
        No recent activity history.
      </div>
      {{/if}}
    </div>
  </div>

  <!-- Chart Container -->
  <div class="dashboard-card"
    style="grid-column: 1 / -1; margin-top: 20px">
    <div class="card-header">
      <div class="card-title glitch" data-text="NEBURA TEMPORAL ANALYSIS"
        data-lang-key="temporal-analysis">
        NEBURA TEMPORAL ANALYSIS
      </div>
      <div class="card-icon">
        <svg width="18" height="18" viewBox="0 0 24 24"
          fill="currentColor">
          <path
            d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z" />
        </svg>
      </div>
    </div>
    <div
      style="
              height: 250px;
              background: var(--accent-bg);
              border-radius: 8px;
              display: flex;
              align-items: center;
              justify-content: center;
              color: var(--text-secondary);
              font-size: 14px;
              font-weight: 500;
            ">
      <div class="loading"></div>
      <span style="margin-left: 10px"
        data-lang-key="loading-chart">Loading advanced analysis...</span>
    </div>
  </div>
</div>

<!-- Examples Section -->
{{> dashboard/examples }}

<!-- Profile Section -->
{{> dashboard/profiles }}

<!-- Licenses Section -->
{{> dashboard/licence }}

<!-- Activity Section -->
{{> dashboard/activity }}

<!-- Support Section -->
{{> dashboard/support }}

<!-- Quick Start Section -->
{{> dashboard/tutorial }}

<!-- Administration Section -->
{{> dashboard/administration }}

<script
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script
  src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script
  src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<script src="/js/dashboard/chart.js"></script>
<script src="/js/dashboard/interface.js"></script>
<script src="/js/dashboard/tickets.js"></script>
<script src="/js/dashboard/licence.js"></script>
<script src="/js/dashboard/ticket-admin.js"></script>
<script src="/js/dashboard/functions.js"></script>
<script>
      window.user = {{{json user}}};
</script>